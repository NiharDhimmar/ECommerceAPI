<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <system.webServer>
    <handlers>
      <!--
      This handler maps all requests to the FastCGI module.
      The 'scriptProcessor' points to your Python executable and the wfastcgi.py script.
      You MUST replace 'C:\path\to\your\python.exe' and 'C:\path\to\your\wfastcgi.py'
      with the actual paths found when you ran 'wfastcgi-enable'.
      -->
      <add name="Python FastCGI"
           path="*"
           verb="*"
           modules="FastCgiModule"
           scriptProcessor="C:\Program Files\Python310\python.exe"|"C:\Program Files\Python310\lib\site-packages\wfastcgi.py"
           resourceType="Unspecified"
           requireAccess="Script" />
    </handlers>
    <rewrite>
      <rules>
        <!--
        This rule rewrites all requests to your app.py,
        allowing Flask to handle routing.
        -->
        <rule name="Flask Catch All" stopProcessing="true">
          <match url="^(.*)$" ignoreCase="false" />
          <conditions logicalGrouping="And">
            <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
            <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
          </conditions>
          <action type="Rewrite" url="app.py/{R:1}" />
        </rule>
      </rules>
    </rewrite>
  </system.webServer>
  <appSettings>
    <!--
    These settings are crucial for wfastcgi to find and run your Flask application.
    'WSGI_HANDLER' should point to your Flask app instance:
    'app.py' (your file name) : 'app' (the Flask application object in app.py)
    -->
    <add key="WSGI_HANDLER" value="app.app" />
    <!--
    Set PYTHONPATH to include your project directory so Python can find app.py.
    Replace 'C:\inetpub\wwwroot\AgenticAI_Project' with your actual project path.
    -->
    <add key="PYTHONPATH" value="C:\inetpub\wwwroot\AgenticAI_Project" />
    <!-- Optional: Set FLASK_ENV to development or production -->
    <add key="FLASK_ENV" value="development" />
  </appSettings>
</configuration>
